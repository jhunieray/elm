SELECT  RTRIM(LTRIM(Name)) as name, RTRIM(LTRIM(B.BillNumber)) as bill_no, RTRIM(LTRIM(C.AccountNumber)) as account_no, CONVERT (varchar,Period,101) as period,
        total_amt =  CONVERT(VARCHAR(20), (CONVERT(MONEY,CONVERT(VARCHAR(20),B.CuMAmount,1),1) +  CONVERT(MONEY,CONVERT(VARCHAR(20),isnull(B.GarbageCharges,0),1),1) + CASE When
                (cast(convert(char(10), getdate(),101) as datetime)) <= B.DueDate then 0.0 else ROUND((B.NetAmount * (SELECT convert(MONEY, convert(varchar,(surcharge /100),20)) from SystemDefaults) ),2) END    ) ,1),
        consumed_amt = CONVERT(varchar(20), B.CuMAmount, 1) ,
        garbage  =  CONVERT (VARCHAR(20),isnull(B.GarbageCharges,0),1) ,
        penalty = CASE When (cast(convert(char(10), getdate(),101) as datetime)) <= B.DueDate then '0.0' else CONVERT(varchar(20), ROUND((B.NetAmount * (SELECT convert(MONEY, convert(varchar,(surcharge /100),20)) from SystemDefaults) ),2),1) END,
        CONVERT (varchar,DueDate,101) as due_date
        FROM Bills as B
        INNER JOIN Customers AS c ON B.AccountNumber = C.AccountNumber
        WHERE NOT EXISTS (SELECT AccountNumber FROM Payments as P where P.AccountNumber = B.AccountNumber and P.BillNumber = B.BillNumber)